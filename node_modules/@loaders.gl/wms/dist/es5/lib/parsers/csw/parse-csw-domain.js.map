{"version":3,"file":"parse-csw-domain.js","names":["_xml","require","_parseExceptionReport","parseCSWDomain","text","options","parsedXML","XMLLoader","parseTextSync","xml","removeNSPrefix","uncapitalizeKeys","arrayPaths","parseExceptionReport","xmlDomain","getDomainResponse","domainValue","domainValues","_domainValue$listOfVa","values","listOfValues","value"],"sources":["../../../../../src/lib/parsers/csw/parse-csw-domain.ts"],"sourcesContent":["// loaders.gl, MIT license\n\nimport type {XMLLoaderOptions} from '@loaders.gl/xml';\nimport {XMLLoader} from '@loaders.gl/xml';\nimport {parseExceptionReport} from './parse-exception-report';\n\n/** Describes the values of resource */\nexport type CSWDomain = {\n  domainValues: {\n    type: string;\n    propertyName: string;\n    values: {\n      [key: string]: unknown;\n    }[];\n  }[];\n};\n\n/**\n * Parses a typed data structure from raw XML for `GetDomain` response\n * @note Error handlings is fairly weak\n */\nexport function parseCSWDomain(text: string, options?: XMLLoaderOptions): CSWDomain {\n  const parsedXML = XMLLoader.parseTextSync(text, {\n    ...options,\n    xml: {\n      ...options?.xml,\n      removeNSPrefix: true,\n      uncapitalizeKeys: true,\n      arrayPaths: [\n        'GetDomainResponse.DomainValues',\n        'GetDomainResponse.DomainValues.ListOfValues.value'\n      ]\n    }\n  });\n\n  parseExceptionReport(parsedXML);\n\n  const xmlDomain: any = parsedXML.getDomainResponse;\n  for (const domainValue of xmlDomain.domainValues) {\n    // Drop the nested <listOfValues><value><value><listOfValues>  => values[]\n    domainValue.values = domainValue.listOfValues?.value;\n    delete domainValue.listOfValues;\n  }\n  return xmlDomain as CSWDomain;\n}\n"],"mappings":";;;;;;AAGA,IAAAA,IAAA,GAAAC,OAAA;AACA,IAAAC,qBAAA,GAAAD,OAAA;AAiBO,SAASE,cAAcA,CAACC,IAAY,EAAEC,OAA0B,EAAa;EAClF,MAAMC,SAAS,GAAGC,cAAS,CAACC,aAAa,CAACJ,IAAI,EAAE;IAC9C,GAAGC,OAAO;IACVI,GAAG,EAAE;MACH,IAAGJ,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEI,GAAG;MACfC,cAAc,EAAE,IAAI;MACpBC,gBAAgB,EAAE,IAAI;MACtBC,UAAU,EAAE,CACV,gCAAgC,EAChC,mDAAmD;IAEvD;EACF,CAAC,CAAC;EAEF,IAAAC,0CAAoB,EAACP,SAAS,CAAC;EAE/B,MAAMQ,SAAc,GAAGR,SAAS,CAACS,iBAAiB;EAClD,KAAK,MAAMC,WAAW,IAAIF,SAAS,CAACG,YAAY,EAAE;IAAA,IAAAC,qBAAA;IAEhDF,WAAW,CAACG,MAAM,IAAAD,qBAAA,GAAGF,WAAW,CAACI,YAAY,cAAAF,qBAAA,uBAAxBA,qBAAA,CAA0BG,KAAK;IACpD,OAAOL,WAAW,CAACI,YAAY;EACjC;EACA,OAAON,SAAS;AAClB"}